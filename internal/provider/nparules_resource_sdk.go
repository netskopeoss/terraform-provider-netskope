// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package provider

import (
	"context"
	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/types"
	tfTypes "github.com/netskope/terraform-provider-ns/internal/provider/types"
	"github.com/netskope/terraform-provider-ns/internal/sdk/models/operations"
	"github.com/netskope/terraform-provider-ns/internal/sdk/models/shared"
)

func (r *NPARulesResourceModel) RefreshFromSharedNpaPolicyResponseItem(ctx context.Context, resp *shared.NpaPolicyResponseItem) diag.Diagnostics {
	var diags diag.Diagnostics

	if resp != nil {
		r.Enabled = types.StringPointerValue(resp.Enabled)
		r.GroupID = types.StringPointerValue(resp.GroupID)
		r.ModifyBy = types.StringPointerValue(resp.ModifyBy)
		r.ModifyTime = types.StringPointerValue(resp.ModifyTime)
		r.ModifyType = types.StringPointerValue(resp.ModifyType)
		r.PolicyType = types.StringPointerValue(resp.PolicyType)
		if resp.RuleData == nil {
			r.RuleData = nil
		} else {
			r.RuleData = &tfTypes.NpaPolicyRuleData{}
			r.RuleData.AccessMethod = make([]types.String, 0, len(resp.RuleData.AccessMethod))
			for _, v := range resp.RuleData.AccessMethod {
				r.RuleData.AccessMethod = append(r.RuleData.AccessMethod, types.StringValue(string(v)))
			}
			r.RuleData.BNegateNetLocation = types.BoolPointerValue(resp.RuleData.BNegateNetLocation)
			r.RuleData.BNegateSrcCountries = types.BoolPointerValue(resp.RuleData.BNegateSrcCountries)
			r.RuleData.Classification = types.StringPointerValue(resp.RuleData.Classification)
			r.RuleData.DeviceClassificationID = make([]types.Int64, 0, len(resp.RuleData.DeviceClassificationID))
			for _, v := range resp.RuleData.DeviceClassificationID {
				r.RuleData.DeviceClassificationID = append(r.RuleData.DeviceClassificationID, types.Int64Value(v))
			}
			r.RuleData.DlpActions = []tfTypes.NpaPolicyRuleDlp{}
			if len(r.RuleData.DlpActions) > len(resp.RuleData.DlpActions) {
				r.RuleData.DlpActions = r.RuleData.DlpActions[:len(resp.RuleData.DlpActions)]
			}
			for dlpActionsCount, dlpActionsItem := range resp.RuleData.DlpActions {
				var dlpActions tfTypes.NpaPolicyRuleDlp
				dlpActions.Actions = make([]types.String, 0, len(dlpActionsItem.Actions))
				for _, v := range dlpActionsItem.Actions {
					dlpActions.Actions = append(dlpActions.Actions, types.StringValue(string(v)))
				}
				dlpActions.DlpProfile = types.StringPointerValue(dlpActionsItem.DlpProfile)
				if dlpActionsCount+1 > len(r.RuleData.DlpActions) {
					r.RuleData.DlpActions = append(r.RuleData.DlpActions, dlpActions)
				} else {
					r.RuleData.DlpActions[dlpActionsCount].Actions = dlpActions.Actions
					r.RuleData.DlpActions[dlpActionsCount].DlpProfile = dlpActions.DlpProfile
				}
			}
			r.RuleData.ExternalDlp = types.BoolPointerValue(resp.RuleData.ExternalDlp)
			r.RuleData.JSONVersion = types.Int64PointerValue(resp.RuleData.JSONVersion)
			if resp.RuleData.MatchCriteriaAction == nil {
				r.RuleData.MatchCriteriaAction = nil
			} else {
				r.RuleData.MatchCriteriaAction = &tfTypes.MatchCriteriaAction{}
				if resp.RuleData.MatchCriteriaAction.ActionName != nil {
					r.RuleData.MatchCriteriaAction.ActionName = types.StringValue(string(*resp.RuleData.MatchCriteriaAction.ActionName))
				} else {
					r.RuleData.MatchCriteriaAction.ActionName = types.StringNull()
				}
			}
			r.RuleData.NetLocationObj = make([]types.String, 0, len(resp.RuleData.NetLocationObj))
			for _, v := range resp.RuleData.NetLocationObj {
				r.RuleData.NetLocationObj = append(r.RuleData.NetLocationObj, types.StringValue(v))
			}
			r.RuleData.OrganizationUnits = make([]types.String, 0, len(resp.RuleData.OrganizationUnits))
			for _, v := range resp.RuleData.OrganizationUnits {
				r.RuleData.OrganizationUnits = append(r.RuleData.OrganizationUnits, types.StringValue(v))
			}
			if resp.RuleData.PolicyType != nil {
				r.RuleData.PolicyType = types.StringValue(string(*resp.RuleData.PolicyType))
			} else {
				r.RuleData.PolicyType = types.StringNull()
			}
			r.RuleData.PrivateApps = make([]types.String, 0, len(resp.RuleData.PrivateApps))
			for _, v := range resp.RuleData.PrivateApps {
				r.RuleData.PrivateApps = append(r.RuleData.PrivateApps, types.StringValue(v))
			}
			r.RuleData.PrivateAppsWithActivities = []tfTypes.PrivateAppsWithActivities{}
			if len(r.RuleData.PrivateAppsWithActivities) > len(resp.RuleData.PrivateAppsWithActivities) {
				r.RuleData.PrivateAppsWithActivities = r.RuleData.PrivateAppsWithActivities[:len(resp.RuleData.PrivateAppsWithActivities)]
			}
			for privateAppsWithActivitiesCount, privateAppsWithActivitiesItem := range resp.RuleData.PrivateAppsWithActivities {
				var privateAppsWithActivities tfTypes.PrivateAppsWithActivities
				privateAppsWithActivities.Activities = []tfTypes.Activities{}
				for activitiesCount, activitiesItem := range privateAppsWithActivitiesItem.Activities {
					var activities tfTypes.Activities
					if activitiesItem.Activity != nil {
						activities.Activity = types.StringValue(string(*activitiesItem.Activity))
					} else {
						activities.Activity = types.StringNull()
					}
					activities.ListOfConstraints = make([]types.String, 0, len(activitiesItem.ListOfConstraints))
					for _, v := range activitiesItem.ListOfConstraints {
						activities.ListOfConstraints = append(activities.ListOfConstraints, types.StringValue(v))
					}
					if activitiesCount+1 > len(privateAppsWithActivities.Activities) {
						privateAppsWithActivities.Activities = append(privateAppsWithActivities.Activities, activities)
					} else {
						privateAppsWithActivities.Activities[activitiesCount].Activity = activities.Activity
						privateAppsWithActivities.Activities[activitiesCount].ListOfConstraints = activities.ListOfConstraints
					}
				}
				privateAppsWithActivities.AppID = make([]types.String, 0, len(privateAppsWithActivitiesItem.AppID))
				for _, v := range privateAppsWithActivitiesItem.AppID {
					privateAppsWithActivities.AppID = append(privateAppsWithActivities.AppID, types.StringValue(v))
				}
				privateAppsWithActivities.AppName = types.StringPointerValue(privateAppsWithActivitiesItem.AppName)
				if privateAppsWithActivitiesCount+1 > len(r.RuleData.PrivateAppsWithActivities) {
					r.RuleData.PrivateAppsWithActivities = append(r.RuleData.PrivateAppsWithActivities, privateAppsWithActivities)
				} else {
					r.RuleData.PrivateAppsWithActivities[privateAppsWithActivitiesCount].Activities = privateAppsWithActivities.Activities
					r.RuleData.PrivateAppsWithActivities[privateAppsWithActivitiesCount].AppID = privateAppsWithActivities.AppID
					r.RuleData.PrivateAppsWithActivities[privateAppsWithActivitiesCount].AppName = privateAppsWithActivities.AppName
				}
			}
			r.RuleData.PrivateAppTagIds = make([]types.String, 0, len(resp.RuleData.PrivateAppTagIds))
			for _, v := range resp.RuleData.PrivateAppTagIds {
				r.RuleData.PrivateAppTagIds = append(r.RuleData.PrivateAppTagIds, types.StringValue(v))
			}
			r.RuleData.PrivateAppTags = make([]types.String, 0, len(resp.RuleData.PrivateAppTags))
			for _, v := range resp.RuleData.PrivateAppTags {
				r.RuleData.PrivateAppTags = append(r.RuleData.PrivateAppTags, types.StringValue(v))
			}
			r.RuleData.ShowDlpProfileActionTable = types.BoolPointerValue(resp.RuleData.ShowDlpProfileActionTable)
			r.RuleData.SrcCountries = make([]types.String, 0, len(resp.RuleData.SrcCountries))
			for _, v := range resp.RuleData.SrcCountries {
				r.RuleData.SrcCountries = append(r.RuleData.SrcCountries, types.StringValue(v))
			}
			r.RuleData.TssActions = []tfTypes.NpaPolicyRuleTss{}
			if len(r.RuleData.TssActions) > len(resp.RuleData.TssActions) {
				r.RuleData.TssActions = r.RuleData.TssActions[:len(resp.RuleData.TssActions)]
			}
			for tssActionsCount, tssActionsItem := range resp.RuleData.TssActions {
				var tssActions tfTypes.NpaPolicyRuleTss
				tssActions.Actions = []tfTypes.NpaPolicyRuleTssActions{}
				for actionsCount, actionsItem := range tssActionsItem.Actions {
					var actions tfTypes.NpaPolicyRuleTssActions
					if actionsItem.ActionName != nil {
						actions.ActionName = types.StringValue(string(*actionsItem.ActionName))
					} else {
						actions.ActionName = types.StringNull()
					}
					actions.RemediationProfile = types.StringPointerValue(actionsItem.RemediationProfile)
					if actionsItem.Severity != nil {
						actions.Severity = types.StringValue(string(*actionsItem.Severity))
					} else {
						actions.Severity = types.StringNull()
					}
					actions.Template = types.StringPointerValue(actionsItem.Template)
					if actionsCount+1 > len(tssActions.Actions) {
						tssActions.Actions = append(tssActions.Actions, actions)
					} else {
						tssActions.Actions[actionsCount].ActionName = actions.ActionName
						tssActions.Actions[actionsCount].RemediationProfile = actions.RemediationProfile
						tssActions.Actions[actionsCount].Severity = actions.Severity
						tssActions.Actions[actionsCount].Template = actions.Template
					}
				}
				tssActions.TssProfile = make([]types.String, 0, len(tssActionsItem.TssProfile))
				for _, v := range tssActionsItem.TssProfile {
					tssActions.TssProfile = append(tssActions.TssProfile, types.StringValue(v))
				}
				if tssActionsCount+1 > len(r.RuleData.TssActions) {
					r.RuleData.TssActions = append(r.RuleData.TssActions, tssActions)
				} else {
					r.RuleData.TssActions[tssActionsCount].Actions = tssActions.Actions
					r.RuleData.TssActions[tssActionsCount].TssProfile = tssActions.TssProfile
				}
			}
			r.RuleData.TssProfile = make([]types.String, 0, len(resp.RuleData.TssProfile))
			for _, v := range resp.RuleData.TssProfile {
				r.RuleData.TssProfile = append(r.RuleData.TssProfile, types.StringValue(v))
			}
			r.RuleData.UserGroups = make([]types.String, 0, len(resp.RuleData.UserGroups))
			for _, v := range resp.RuleData.UserGroups {
				r.RuleData.UserGroups = append(r.RuleData.UserGroups, types.StringValue(v))
			}
			r.RuleData.Users = make([]types.String, 0, len(resp.RuleData.Users))
			for _, v := range resp.RuleData.Users {
				r.RuleData.Users = append(r.RuleData.Users, types.StringValue(v))
			}
			if resp.RuleData.UserType != nil {
				r.RuleData.UserType = types.StringValue(string(*resp.RuleData.UserType))
			} else {
				r.RuleData.UserType = types.StringNull()
			}
			r.RuleData.Version = types.Int64PointerValue(resp.RuleData.Version)
		}
		r.RuleID = types.StringPointerValue(resp.RuleID)
		r.RuleName = types.StringPointerValue(resp.RuleName)
	}

	return diags
}

func (r *NPARulesResourceModel) ToOperationsCreateNPARulesRequest(ctx context.Context) (*operations.CreateNPARulesRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	silent := new(operations.QueryParamSilent)
	if !r.Silent.IsUnknown() && !r.Silent.IsNull() {
		*silent = operations.QueryParamSilent(r.Silent.ValueString())
	} else {
		silent = nil
	}
	npaPolicyRequest, npaPolicyRequestDiags := r.ToSharedNpaPolicyRequest(ctx)
	diags.Append(npaPolicyRequestDiags...)

	if diags.HasError() {
		return nil, diags
	}

	out := operations.CreateNPARulesRequest{
		Silent:           silent,
		NpaPolicyRequest: *npaPolicyRequest,
	}

	return &out, diags
}

func (r *NPARulesResourceModel) ToOperationsDeleteNPARulesRequest(ctx context.Context) (*operations.DeleteNPARulesRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var ruleID string
	ruleID = r.RuleID.ValueString()

	out := operations.DeleteNPARulesRequest{
		RuleID: ruleID,
	}

	return &out, diags
}

func (r *NPARulesResourceModel) ToOperationsNPARulesRequest(ctx context.Context) (*operations.NPARulesRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var ruleID string
	ruleID = r.RuleID.ValueString()

	out := operations.NPARulesRequest{
		RuleID: ruleID,
	}

	return &out, diags
}

func (r *NPARulesResourceModel) ToOperationsUpdateNPARulesByIDRequest(ctx context.Context) (*operations.UpdateNPARulesByIDRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var ruleID string
	ruleID = r.RuleID.ValueString()

	silent := new(operations.UpdateNPARulesByIDQueryParamSilent)
	if !r.Silent.IsUnknown() && !r.Silent.IsNull() {
		*silent = operations.UpdateNPARulesByIDQueryParamSilent(r.Silent.ValueString())
	} else {
		silent = nil
	}
	npaPolicyRequest, npaPolicyRequestDiags := r.ToSharedNpaPolicyRequest(ctx)
	diags.Append(npaPolicyRequestDiags...)

	if diags.HasError() {
		return nil, diags
	}

	out := operations.UpdateNPARulesByIDRequest{
		RuleID:           ruleID,
		Silent:           silent,
		NpaPolicyRequest: *npaPolicyRequest,
	}

	return &out, diags
}

func (r *NPARulesResourceModel) ToSharedNpaPolicyRequest(ctx context.Context) (*shared.NpaPolicyRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	description := new(string)
	if !r.Description.IsUnknown() && !r.Description.IsNull() {
		*description = r.Description.ValueString()
	} else {
		description = nil
	}
	enabled := new(string)
	if !r.Enabled.IsUnknown() && !r.Enabled.IsNull() {
		*enabled = r.Enabled.ValueString()
	} else {
		enabled = nil
	}
	groupID := new(string)
	if !r.GroupID.IsUnknown() && !r.GroupID.IsNull() {
		*groupID = r.GroupID.ValueString()
	} else {
		groupID = nil
	}
	groupName := new(string)
	if !r.GroupName.IsUnknown() && !r.GroupName.IsNull() {
		*groupName = r.GroupName.ValueString()
	} else {
		groupName = nil
	}
	var ruleData *shared.NpaPolicyRuleData
	if r.RuleData != nil {
		accessMethod := make([]shared.AccessMethod, 0, len(r.RuleData.AccessMethod))
		for _, accessMethodItem := range r.RuleData.AccessMethod {
			accessMethod = append(accessMethod, shared.AccessMethod(accessMethodItem.ValueString()))
		}
		bNegateNetLocation := new(bool)
		if !r.RuleData.BNegateNetLocation.IsUnknown() && !r.RuleData.BNegateNetLocation.IsNull() {
			*bNegateNetLocation = r.RuleData.BNegateNetLocation.ValueBool()
		} else {
			bNegateNetLocation = nil
		}
		bNegateSrcCountries := new(bool)
		if !r.RuleData.BNegateSrcCountries.IsUnknown() && !r.RuleData.BNegateSrcCountries.IsNull() {
			*bNegateSrcCountries = r.RuleData.BNegateSrcCountries.ValueBool()
		} else {
			bNegateSrcCountries = nil
		}
		classification := new(string)
		if !r.RuleData.Classification.IsUnknown() && !r.RuleData.Classification.IsNull() {
			*classification = r.RuleData.Classification.ValueString()
		} else {
			classification = nil
		}
		dlpActions := make([]shared.NpaPolicyRuleDlp, 0, len(r.RuleData.DlpActions))
		for _, dlpActionsItem := range r.RuleData.DlpActions {
			actions := make([]shared.Actions, 0, len(dlpActionsItem.Actions))
			for _, actionsItem := range dlpActionsItem.Actions {
				actions = append(actions, shared.Actions(actionsItem.ValueString()))
			}
			dlpProfile := new(string)
			if !dlpActionsItem.DlpProfile.IsUnknown() && !dlpActionsItem.DlpProfile.IsNull() {
				*dlpProfile = dlpActionsItem.DlpProfile.ValueString()
			} else {
				dlpProfile = nil
			}
			dlpActions = append(dlpActions, shared.NpaPolicyRuleDlp{
				Actions:    actions,
				DlpProfile: dlpProfile,
			})
		}
		tssActions := make([]shared.NpaPolicyRuleTss, 0, len(r.RuleData.TssActions))
		for _, tssActionsItem := range r.RuleData.TssActions {
			tssProfile := make([]string, 0, len(tssActionsItem.TssProfile))
			for _, tssProfileItem := range tssActionsItem.TssProfile {
				tssProfile = append(tssProfile, tssProfileItem.ValueString())
			}
			actions1 := make([]shared.NpaPolicyRuleTssActions, 0, len(tssActionsItem.Actions))
			for _, actionsItem1 := range tssActionsItem.Actions {
				actionName := new(shared.ActionName)
				if !actionsItem1.ActionName.IsUnknown() && !actionsItem1.ActionName.IsNull() {
					*actionName = shared.ActionName(actionsItem1.ActionName.ValueString())
				} else {
					actionName = nil
				}
				remediationProfile := new(string)
				if !actionsItem1.RemediationProfile.IsUnknown() && !actionsItem1.RemediationProfile.IsNull() {
					*remediationProfile = actionsItem1.RemediationProfile.ValueString()
				} else {
					remediationProfile = nil
				}
				severity := new(shared.Severity)
				if !actionsItem1.Severity.IsUnknown() && !actionsItem1.Severity.IsNull() {
					*severity = shared.Severity(actionsItem1.Severity.ValueString())
				} else {
					severity = nil
				}
				template := new(string)
				if !actionsItem1.Template.IsUnknown() && !actionsItem1.Template.IsNull() {
					*template = actionsItem1.Template.ValueString()
				} else {
					template = nil
				}
				actions1 = append(actions1, shared.NpaPolicyRuleTssActions{
					ActionName:         actionName,
					RemediationProfile: remediationProfile,
					Severity:           severity,
					Template:           template,
				})
			}
			tssActions = append(tssActions, shared.NpaPolicyRuleTss{
				TssProfile: tssProfile,
				Actions:    actions1,
			})
		}
		tssProfile1 := make([]string, 0, len(r.RuleData.TssProfile))
		for _, tssProfileItem1 := range r.RuleData.TssProfile {
			tssProfile1 = append(tssProfile1, tssProfileItem1.ValueString())
		}
		externalDlp := new(bool)
		if !r.RuleData.ExternalDlp.IsUnknown() && !r.RuleData.ExternalDlp.IsNull() {
			*externalDlp = r.RuleData.ExternalDlp.ValueBool()
		} else {
			externalDlp = nil
		}
		jsonVersion := new(int64)
		if !r.RuleData.JSONVersion.IsUnknown() && !r.RuleData.JSONVersion.IsNull() {
			*jsonVersion = r.RuleData.JSONVersion.ValueInt64()
		} else {
			jsonVersion = nil
		}
		deviceClassificationID := make([]int64, 0, len(r.RuleData.DeviceClassificationID))
		for _, deviceClassificationIDItem := range r.RuleData.DeviceClassificationID {
			deviceClassificationID = append(deviceClassificationID, deviceClassificationIDItem.ValueInt64())
		}
		var matchCriteriaAction *shared.MatchCriteriaAction
		if r.RuleData.MatchCriteriaAction != nil {
			actionName1 := new(shared.NpaPolicyRuleDataActionName)
			if !r.RuleData.MatchCriteriaAction.ActionName.IsUnknown() && !r.RuleData.MatchCriteriaAction.ActionName.IsNull() {
				*actionName1 = shared.NpaPolicyRuleDataActionName(r.RuleData.MatchCriteriaAction.ActionName.ValueString())
			} else {
				actionName1 = nil
			}
			matchCriteriaAction = &shared.MatchCriteriaAction{
				ActionName: actionName1,
			}
		}
		netLocationObj := make([]string, 0, len(r.RuleData.NetLocationObj))
		for _, netLocationObjItem := range r.RuleData.NetLocationObj {
			netLocationObj = append(netLocationObj, netLocationObjItem.ValueString())
		}
		organizationUnits := make([]string, 0, len(r.RuleData.OrganizationUnits))
		for _, organizationUnitsItem := range r.RuleData.OrganizationUnits {
			organizationUnits = append(organizationUnits, organizationUnitsItem.ValueString())
		}
		policyType := new(shared.PolicyType)
		if !r.RuleData.PolicyType.IsUnknown() && !r.RuleData.PolicyType.IsNull() {
			*policyType = shared.PolicyType(r.RuleData.PolicyType.ValueString())
		} else {
			policyType = nil
		}
		privateAppTagIds := make([]string, 0, len(r.RuleData.PrivateAppTagIds))
		for _, privateAppTagIdsItem := range r.RuleData.PrivateAppTagIds {
			privateAppTagIds = append(privateAppTagIds, privateAppTagIdsItem.ValueString())
		}
		privateAppTags := make([]string, 0, len(r.RuleData.PrivateAppTags))
		for _, privateAppTagsItem := range r.RuleData.PrivateAppTags {
			privateAppTags = append(privateAppTags, privateAppTagsItem.ValueString())
		}
		privateApps := make([]string, 0, len(r.RuleData.PrivateApps))
		for _, privateAppsItem := range r.RuleData.PrivateApps {
			privateApps = append(privateApps, privateAppsItem.ValueString())
		}
		privateAppsWithActivities := make([]shared.PrivateAppsWithActivities, 0, len(r.RuleData.PrivateAppsWithActivities))
		for _, privateAppsWithActivitiesItem := range r.RuleData.PrivateAppsWithActivities {
			activities := make([]shared.Activities, 0, len(privateAppsWithActivitiesItem.Activities))
			for _, activitiesItem := range privateAppsWithActivitiesItem.Activities {
				activity := new(shared.Activity)
				if !activitiesItem.Activity.IsUnknown() && !activitiesItem.Activity.IsNull() {
					*activity = shared.Activity(activitiesItem.Activity.ValueString())
				} else {
					activity = nil
				}
				listOfConstraints := make([]string, 0, len(activitiesItem.ListOfConstraints))
				for _, listOfConstraintsItem := range activitiesItem.ListOfConstraints {
					listOfConstraints = append(listOfConstraints, listOfConstraintsItem.ValueString())
				}
				activities = append(activities, shared.Activities{
					Activity:          activity,
					ListOfConstraints: listOfConstraints,
				})
			}
			appID := make([]string, 0, len(privateAppsWithActivitiesItem.AppID))
			for _, appIDItem := range privateAppsWithActivitiesItem.AppID {
				appID = append(appID, appIDItem.ValueString())
			}
			appName := new(string)
			if !privateAppsWithActivitiesItem.AppName.IsUnknown() && !privateAppsWithActivitiesItem.AppName.IsNull() {
				*appName = privateAppsWithActivitiesItem.AppName.ValueString()
			} else {
				appName = nil
			}
			privateAppsWithActivities = append(privateAppsWithActivities, shared.PrivateAppsWithActivities{
				Activities: activities,
				AppID:      appID,
				AppName:    appName,
			})
		}
		showDlpProfileActionTable := new(bool)
		if !r.RuleData.ShowDlpProfileActionTable.IsUnknown() && !r.RuleData.ShowDlpProfileActionTable.IsNull() {
			*showDlpProfileActionTable = r.RuleData.ShowDlpProfileActionTable.ValueBool()
		} else {
			showDlpProfileActionTable = nil
		}
		srcCountries := make([]string, 0, len(r.RuleData.SrcCountries))
		for _, srcCountriesItem := range r.RuleData.SrcCountries {
			srcCountries = append(srcCountries, srcCountriesItem.ValueString())
		}
		userGroups := make([]string, 0, len(r.RuleData.UserGroups))
		for _, userGroupsItem := range r.RuleData.UserGroups {
			userGroups = append(userGroups, userGroupsItem.ValueString())
		}
		userType := new(shared.UserType)
		if !r.RuleData.UserType.IsUnknown() && !r.RuleData.UserType.IsNull() {
			*userType = shared.UserType(r.RuleData.UserType.ValueString())
		} else {
			userType = nil
		}
		users := make([]string, 0, len(r.RuleData.Users))
		for _, usersItem := range r.RuleData.Users {
			users = append(users, usersItem.ValueString())
		}
		version := new(int64)
		if !r.RuleData.Version.IsUnknown() && !r.RuleData.Version.IsNull() {
			*version = r.RuleData.Version.ValueInt64()
		} else {
			version = nil
		}
		ruleData = &shared.NpaPolicyRuleData{
			AccessMethod:              accessMethod,
			BNegateNetLocation:        bNegateNetLocation,
			BNegateSrcCountries:       bNegateSrcCountries,
			Classification:            classification,
			DlpActions:                dlpActions,
			TssActions:                tssActions,
			TssProfile:                tssProfile1,
			ExternalDlp:               externalDlp,
			JSONVersion:               jsonVersion,
			DeviceClassificationID:    deviceClassificationID,
			MatchCriteriaAction:       matchCriteriaAction,
			NetLocationObj:            netLocationObj,
			OrganizationUnits:         organizationUnits,
			PolicyType:                policyType,
			PrivateAppTagIds:          privateAppTagIds,
			PrivateAppTags:            privateAppTags,
			PrivateApps:               privateApps,
			PrivateAppsWithActivities: privateAppsWithActivities,
			ShowDlpProfileActionTable: showDlpProfileActionTable,
			SrcCountries:              srcCountries,
			UserGroups:                userGroups,
			UserType:                  userType,
			Users:                     users,
			Version:                   version,
		}
	}
	ruleName := new(string)
	if !r.RuleName.IsUnknown() && !r.RuleName.IsNull() {
		*ruleName = r.RuleName.ValueString()
	} else {
		ruleName = nil
	}
	var ruleOrder *shared.RuleOrder
	if r.RuleOrder != nil {
		order := new(shared.Order)
		if !r.RuleOrder.Order.IsUnknown() && !r.RuleOrder.Order.IsNull() {
			*order = shared.Order(r.RuleOrder.Order.ValueString())
		} else {
			order = nil
		}
		position := new(int64)
		if !r.RuleOrder.Position.IsUnknown() && !r.RuleOrder.Position.IsNull() {
			*position = r.RuleOrder.Position.ValueInt64()
		} else {
			position = nil
		}
		ruleID := new(string)
		if !r.RuleOrder.RuleID.IsUnknown() && !r.RuleOrder.RuleID.IsNull() {
			*ruleID = r.RuleOrder.RuleID.ValueString()
		} else {
			ruleID = nil
		}
		ruleName1 := new(string)
		if !r.RuleOrder.RuleName.IsUnknown() && !r.RuleOrder.RuleName.IsNull() {
			*ruleName1 = r.RuleOrder.RuleName.ValueString()
		} else {
			ruleName1 = nil
		}
		ruleOrder = &shared.RuleOrder{
			Order:    order,
			Position: position,
			RuleID:   ruleID,
			RuleName: ruleName1,
		}
	}
	out := shared.NpaPolicyRequest{
		Description: description,
		Enabled:     enabled,
		GroupID:     groupID,
		GroupName:   groupName,
		RuleData:    ruleData,
		RuleName:    ruleName,
		RuleOrder:   ruleOrder,
	}

	return &out, diags
}
